참고 자료
https://gyoogle.dev/blog/computer-science/computer-architecture/%EC%A4%91%EC%95%99%EC%B2%98%EB%A6%AC%EC%9E%A5%EC%B9%98%20%EC%9E%91%EB%8F%99%20%EC%9B%90%EB%A6%AC.html
https://ndb796.tistory.com/7?category=897801

# 중앙처리장치(CPU) 작동 원리

![image](https://user-images.githubusercontent.com/24373728/165308543-45ae6ebd-1865-49cb-b2ed-defc5aa115a6.png)


## 중앙처리장치(CPU)
- 정의: 컴퓨터 시스템을 통제하고 프로그램의 연산을 실행, 처리하는 가장 핵심적인 컴퓨터의 제어 장치로, 인간으로 비유하면 두뇌에 해당하는 장치이다.

#### 구성 요소
- 산술논리연산장치(ALU): 산술 연산과 논리 연산을 수행한다
  - 연산에 필요한 데이터를 레지스터에서 가져오고, 연산 결과를 다시 레지스터로 보낸다.
- 제어 장치: 명령어를 순서대로 실행할 수 있도록 제어하는 장치
  - 입출력 장치 간 통신 및 조율을 제어하고, 명령어들을 읽고 해석하며 데이터 처리를 위한 시퀸스(처리 순서)를 결정한다.
  - 이때 필요한 제어 신호를 신호가 필요한 장치(기억장치, 연산장치, 입출력장치)로 보낸다.
- 레지스터(Register): 프로세서 내에서 자료를 보관하는 고속 기억 장치이다.
  - 일반적으로 현재 계산을 수행중인 값을 저장하는 데 사용된다.
  - CPU의 종류에 따라 사용할 수 있는 레지스터의 개수와 크기가 다르다.
  - 현대 프로세서는 메인 메모리에서 레지스터로 데이터를 옮겨와 데이터를 처리한 후 다시 메인 메모리로 저장하는 로드-스토어 설계를 사용한다.
#### 레지스터의 구분
- 레지스터는 용도에 따라 범용 레지스터와 특수 목적 레지스터로 구분된다.
- 범용 레지스터: 연산에 필요한 데이터나 연산 결과를 임시로 저장하는 레지스터
- 특수 목적 레지스터: 특별한 용도로 사용하는 레지스터로, 이또한 용도와 기능에 따라 구분된다.
#### 특수 목적 레지스터의 종류
  - 프로그램 카운터(PC): 다음에 실행할 명령어(Instruction)의 주소를 가지고 있다.
  - 명령어 레지스터(IR): 현재 수행 중인 명령어를 가지고 있다.
  - 메모리 주소 레지스터(MAR): 메모리로부터 읽어오거나 메모리에 쓰기 위한 주소를 가지고 있다.
  - 메모리 버퍼 레지스터(MBR): 메모리로부터 읽어온 데이터 또는 메모리에 써야할 데이터를 가지고 있다.
  - 입출력 주소 레지스터(I/O AR): 입출력 장치에 따른 입출력 모듈의 주소를 가지고 있다.
  - 입출력 버퍼 레지스터(I/O BR): 입출력 모듈과 프로세서 간의 데이터 교환을 위해 사용된다.
  - 누산기(AC): 연산 결과를 임시로 저장한다.
  * (여기서 버퍼는, 입출력 중 데이터를 보유하기 위한 주 메모리 영역이다)

## CPU의 동작 과정
1. CPU는 입력장치에서 입력받은 데이터 혹은 보조기억장치에 저장된 프로그램을 읽어온다.
2. CPU는 프로그램을 실행하기 위해 주기억장치에 저장된 프로그램 명령어와 데이터를 읽어와 처리하고 결과를 다시 주기억장치에 저장한다.
3. CPU는 처리 결과를 보조기억장치에 저장하거나 출력장치로 보낸다.
4. 제어장치는 1~3 과정에서 명령어가 순서대로 실행될 수 있도록 각 장치를 제어한다.

#### 명령어 집합(Instruction Set)
- 정의: CPU가 실행할 명령어의 집합으로 CPU에 따라 형식과 종류가 서로 다르다. 
- 명령어의 각 비트는 기능적으로 분할하여 의미를 부여하고 숫자화한다.
- 이때 숫자화된 기계어와 일대일로 문자화한 것이 어셈블리어이다.
- 명령어는 실행할 연산을 나타내는 연산 코드(Operation Code)와 연산에 필요한 데이터나 데이터의 저장 위치를 나타내는 피연산자(Operand)로 구성된다.
- 연산 코드: 연산, 제어, 데이터 전달, 입출력 기능을 갖는 코드
- 피연산자: 주소, 숫자/문자, 논리 데이터 등을 저장한다.

![image](https://user-images.githubusercontent.com/24373728/165314888-92aff347-4af0-4d8f-8d2a-76e987a2402b.png)

#### 연산코드의 기능에 따른 구분
- 연산: 산술연산과 논리연산을 수행한다
- 제어: 조건 분기와 무조건 분기 등을 사용하여 명령어의 실행 순서를 제어한다
- 데이터 전달: 레지스터-레지스터, 레지스터-주기억장치 사이 데이터를 전달한다
- 입출력: 프로그램과 데이터를 주기억장치에 전달하고, 연산 결과는 출력장치로 전달한다.

#### 피연산자
- 주소: 기억장치 혹은 레지스터의 주소가 저장된다
- 숫자/문자: 정수, 고정 소수점, 부동 소수점, 그리고 아스키 코드로 데이터를 저장한다
- 논리 데이터: 참/거짓을 표현할 때 사용하며 비트나 플래그 등으로 저장된다

#### 명령어 사이클(Instruection Cycle)
- CPU는 프로그램을 실행하기 위해 주기억장치에서 명령어를 순차적으로 인출하여 해독하고 실행하는 과정을 반복한다.
- CPU가 주기억장치에서 한 번에 하나의 명령어를 인출하여 실행하는데 필요한 일련의 활동을 `명령어 사이클`이라 한다.
- 명렁어 사이클은 인출 사이클과 실행 사이클로 나뉜다.
- 인출 사이클은 주기억장치에서 하나의 명령어를 가져오고, 실행 사이클은 명령어를 실행한다.
- 이후 하나의 사이클이 종료되면 다음 명령어에 대한 인출 사이클이 시작되며 반복.

![image](https://user-images.githubusercontent.com/24373728/165317447-f7da3914-ded4-45e1-96cb-969ab5b76445.png)

- 이를 더 세분화하면, 간접 사이클과 인터럽트 사이클이 추가된다. 이들은 주소 지정 방식이 필요하거나 인터럽트 요구가 있을 때만 수행된다.

### 인출 사이클과 실행 사이클에 의한 명령어 처리 과정
![image](https://user-images.githubusercontent.com/24373728/165320285-ca49810f-cb30-402d-bcb0-f99b2354da2a.png)

- T0 : MAR ← PC
- T1 : MBR ← M[MAR], PC ← PC+1
- T2 : IR ← MBR

1. PC(명령어의 주소를 저장하고 있음)에 저장된 주소를 MAR로 전달
2. 저장된 내용을 토대로 주기억장치의 해당 주소에서 명령어를 인출
3. 인출한 명령어를 MBR에 저장
4. 다음 명령어를 인출하기 위해 PC 값을 증가시킴
5. MBR에 저장된 내용을 IR에 전달




